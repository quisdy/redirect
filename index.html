<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="collections.css">
	<title>Collections</title>
</head>


	

<body>
	
	<a href="javascript:void(0);" onclick="countRedirect(event, 'https://empt1dae.github.io/optimize/')">

		 <img src="4x.png" alt="–ë–∞–Ω–Ω–µ—Ä">
	</a>
	<script type="module">
	   import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Firebase (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–∏)
  const firebaseConfig = {
      apiKey: "AIzaSyDX4WrSs8_7eamobot9Rq38-cig-vXIZyU",
      authDomain: "optimize-adf64.firebaseapp.com",
      projectId: "optimize-adf64",
      storageBucket: "optimize-adf64.firebasestorage.app",
      messagingSenderId: "320149610678",
      appId: "1:320149610678:web:a13c9aaad88592e0094617",
      measurementId: "G-BC2TNFRW0Q"
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // üìå –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–∞ –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
    async function countRedirect(event, targetUrl) {
        event.preventDefault(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
        console.log("–ë–∞–Ω–Ω–µ—Ä –Ω–∞–∂–∞—Ç, –ø—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å Firestore...");

        const counterRef = doc(db, "analytics", "click_counter");

        try {
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –Ω–∞ 1
            await updateDoc(counterRef, { count: increment(1) });
            console.log("‚úÖ Firestore: –£—Å–ø–µ—à–Ω–æ —É–≤–µ–ª–∏—á–∏–ª–∏ —Å—á—ë—Ç—á–∏–∫!");
        } catch (error) {
            console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å—á—ë—Ç—á–∏–∫–∞:", error);
            console.log("–°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç...");

            try {
                // –ï—Å–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞—ë–º –µ–≥–æ —Å count = 1
                await setDoc(counterRef, { count: 1 });
                console.log("‚úÖ Firestore: –î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω!");
            } catch (err) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:", err);
            }
        }

        // üîÄ –†–µ–¥–∏—Ä–µ–∫—Ç —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫. (—á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ–ª–∏ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è)
        setTimeout(() => {
            console.log("‚û°Ô∏è –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–∞–π—Ç...");
            window.location.href = targetUrl;
        }, 500);
    }

window.countRedirect = countRedirect;
</script>
</body>

</html>
