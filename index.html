<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="collections.css">
	<title>Collections</title>
</head>




<body>

	<a href="https://quisdy.github.io/optimization/" onclick="countRedirect(event)" id="a_clean">

		<section class="banner">

			<div class="marquee">
				<div class="marquee-content">
					<h2 class="h2_white">NEW COLLECTION</h2>
					<h2 class="h2_white">NEW COLLECTION</h2>
				</div>
				<!-- –î—É–±–ª–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ -->
				<div class="marquee-content" aria-hidden="true">
					<h2 class="h2_white">NEW COLLECTION</h2>
					<h2 class="h2_white">NEW COLLECTION</h2>
				</div>
			</div>

			<div class="section_banner">
				<div class="container_h1">
					<div class="container_h1_" id="gap_1">
						<img src="img/lus.svg" alt="" class="lustre">
						<h1>
							–ì–æ—Ç–æ–≤—ã —Å–∏—è—Ç—å,
						</h1>
					</div>
					<div class="container_h1_" id="gap_2">
						<h1>
							–∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞?
						</h1>
						<img src="img/tre.svg" alt="" class="lustre">
					</div>
				</div>

				<div class="section_banner_content">
					<div class="banner_text">
						<div class="container_h2">
							<h2 id="gap_2">
								–ù–æ–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è
							</h2>
							<h2 class="h2_purple" id="gap_2">
								—É–∂–µ –≤ –ø—Ä–æ–¥–∞–∂–µ!
							</h2>
						</div>

						<div class="section_text" id="text">
							<p>
								–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å, —Å—Ç–∏–ª—å –∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å ‚Äî —Ç–æ–ª—å–∫–æ –≤ Lustre.
								–£—Å–ø–µ–π—Ç–µ –ø–µ—Ä–≤—ã–º –ø—Ä–∏–∫–æ—Å–Ω—É—Ç—å—Å—è –∫ —Ä–æ—Å–∫–æ—à–∏!
							</p>

							<a href="catalog/catalog.html">
								<button>
									<h4>
										–ø–æ–¥—Ä–æ–±–Ω–µ–µ
									</h4>
								</button>
							</a>
						</div>
					</div>
					<img src="img/stars.svg" id="rings_banner" alt="">
				</div>
			</div>

			<div class="marquee">
				<div class="marquee-content">
					<h2 class="h2_white">NEW COLLECTION</h2>
					<h2 class="h2_white">NEW COLLECTION</h2>
				</div>
				<!-- –î—É–±–ª–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ -->
				<div class="marquee-content" aria-hidden="true">
					<h2 class="h2_white">NEW COLLECTION</h2>
					<h2 class="h2_white">NEW COLLECTION</h2>
				</div>
			</div>
		</section>
	</a>

	<script type="module">
		// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
		import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
		import { getFirestore, doc, setDoc, updateDoc, getDoc, increment } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";
		import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-analytics.js";

		// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
		const firebaseConfig = {
			apiKey: "AIzaSyDX4WrSs8_7eamobot9Rq38-cig-vXIZyU",
			authDomain: "optimize-adf64.firebaseapp.com",
			projectId: "optimize-adf64",
			storageBucket: "optimize-adf64.firebasestorage.app",
			messagingSenderId: "320149610678",
			appId: "1:320149610678:web:a13c9aaad88592e0094617",
			measurementId: "G-BC2TNFRW0Q"
		};

		// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);  // –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
		const db = getFirestore(app); // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å Firestore

		// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–∞
		   window.countRedirect = async function(event) {
        event.preventDefault(); // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥

        const targetUrl = event.currentTarget.href;
        const counterRef = doc(db, "analytics", "click_counter");
        const clicksCollection = collection(db, "clicks");

        try {
            console.log("üîÑ –ù–∞—á–∞–ª–æ –∑–∞–ø–∏—Å–∏ –≤ Firestore...");

            // üîπ 1. –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
            const docSnap = await getDoc(counterRef);
            if (docSnap.exists()) {
                await updateDoc(counterRef, { count: increment(1) });
                console.log("‚úÖ Firestore: –°—á—ë—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª—ë–Ω!");
            } else {
                await setDoc(counterRef, { count: 1 });
                console.log("üî• Firestore: –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Å—á—ë—Ç—á–∏–∫!");
            }

            // üîπ 2. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ "clicks"
            await addDoc(clicksCollection, {
                timestamp: serverTimestamp(),
                ip: "Unknown" // –ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π IP
            });
            console.log("üìå Firestore: –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å –≤ clicks!");

        } catch (error) {
            console.error("‚ùå –û—à–∏–±–∫–∞ Firestore:", error);
        }

        console.log("‚û°Ô∏è –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞", targetUrl);
        window.location.href = targetUrl; // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    };
	</script>

</body>

</html>
